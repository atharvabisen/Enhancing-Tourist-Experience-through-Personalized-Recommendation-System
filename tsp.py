import numpy as np
import pandas as pd
import math
from sys import maxsize
from itertools import permutations


def travellingSalesmanProblem(graph, places):
    vertex = list(range(len(graph)))
    start = vertex[0]
    vertex.remove(start)

    min_path = maxsize
    next_permutation = permutations(vertex)
    min_path_list = None # initialize minimum path list

    for i in next_permutation:
        current_pathweight = 0
        k = start
        current_path = [start] # initialize current path
        for j in i:
            current_pathweight += graph[k][j]
            k = j
            current_path.append(j)
        current_pathweight += graph[k][start]
        current_path.append(start)
        if current_pathweight < min_path:
            min_path = current_pathweight
            min_path_list = current_path # update minimum path list

    # Remove the last element (source) from the minimum path list
    min_path_list = min_path_list[:-1]
    #print("Path:", min_path_list)
    shortest_path_order = [places[i] for i in min_path_list]
    #print(shortest_path_order)
    return shortest_path_order

def tsp(places, source, address):
    dist_matrix = np.array([
    [0, 6.7, 2.6, 4.1, 3.7, 18.1, 16.1, 55.8, 1.2, 3.0, 2.4, 109.0, 38.7, 1.6, 4.6, 8.5, 1.6, 5.0, 38.7, 2.5, 7.5, 3.6, 0.95, 2.2, 49.6, 4.1, 4.2, 1.2, 7.7, 3.8, 5.7, 51.1, 6.5, 55.8, 119.0, 145.0, 35.3, 77.7, 34.8, 41.6, 32.9, 54.3, 50.0, 54.8, 41.4, 105.0, 4.0, 1.2, 1.1, 3.8, 1.5, 2.4, 1.1, 0.95, 2.4, 2.4, 4.6], 
    [6.7, 0, 8.9, 8.4, 3.9, 24.7, 14.2, 63.8, 7.7, 9.6, 8.8, 115.0, 38.7, 8.0, 3.6, 13.7, 8.2, 9.8, 38.6, 9.0, 10.0, 6.1, 7.6, 9.6, 63.8, 6.2, 5.8, 5.6, 14.8, 7.8, 1.4, 57.7, 8.0, 58.1, 126.0, 152.0, 33.5, 84.3, 41.1, 48.2, 39.2, 65.5, 64.2, 69.0, 35.8, 107.0, 7.7, 6.2, 6.0, 10.3, 6.2, 5.3, 6.3, 6.3, 5.6, 8.7, 11.3], 
    [2.6, 8.0, 0, 6.7, 5.2, 18.6, 20.9, 50.0, 3.3, 3.2, 0.45, 109.0, 41.0, 1.5, 5.7, 7.4, 3.3, 7.2, 40.9, 2.1, 5.6, 6.2, 3.5, 4.4, 50.0, 3.8, 6.8, 3.5, 9.9, 6.3, 7.0, 51.9, 9.0, 54.0, 117.0, 144.0, 40.2, 78.5, 37.0, 42.1, 35.2, 56.6, 50.5, 55.3, 49.8, 103.0, 2.2, 2.5, 2.5, 2.7, 2.1, 3.6, 1.9, 2.3, 3.2, 0.85, 5.1], 
    [4.1, 8.8, 6.7, 0, 6.4, 20.6, 13.3, 57.2, 4.9, 6.0, 6.6, 111.0, 31.1, 5.8, 8.0, 11.8, 4.0, 4.9, 31.0, 5.8, 11.5, 2.6, 3.6, 4.7, 57.2, 8.2, 2.6, 4.8, 5.0, 0.35, 7.8, 58.7, 3.7, 59.8, 122.0, 148.0, 32.6, 80.1, 36.2, 49.2, 34.4, 55.8, 57.6, 62.4, 44.4, 109.0, 8.2, 5.3, 5.2, 7.0, 5.7, 5.1, 5.3, 5.1, 5.9, 6.2, 7.1], 
    [3.8, 3.9, 5.2, 5.9, 0, 21.6, 17.1, 59.2, 4.6, 6.5, 5.1, 112.0, 42.2, 4.3, 2.1, 9.9, 5.1, 7.1, 42.1, 5.9, 7.4, 4.9, 4.7, 5.8, 59.2, 2.5, 5.5, 2.2, 10.2, 5.6, 3.1, 60.7, 7.7, 55.7, 121.0, 148.0, 36.3, 81.2, 38.2, 51.2, 36.4, 57.8, 59.6, 64.4, 38.7, 105.0, 4.0, 2.8, 2.6, 7.2, 3.0, 1.1, 2.9, 3.6, 2.3, 5.0, 8.1], 
    [18.0, 24.4, 18.4, 20.3, 21.2, 0, 32.9, 33.6, 18.1, 15.5, 18.1, 92.9, 40.6, 19.0, 22.0, 16.3, 16.3, 17.4, 40.6, 18.1, 20.4, 20.4, 18.1, 17.2, 33.6, 21.5, 21.0, 18.9, 20.8, 20.0, 23.4, 35.1, 23.2, 60.1, 112.0, 138.0, 52.1, 61.7, 36.7, 25.7, 36.3, 62.7, 34.0, 38.8, 64.0, 109.0, 19.5, 18.6, 18.5, 16.0, 18.9, 20.1, 18.5, 18.3, 19.2, 17.8, 14.2], 
    [15.3, 14.2, 17.6, 15.3, 17.1, 32.9, 0, 64.3, 19.0, 18.4, 17.5, 124.0, 33.2, 16.6, 17.6, 26.3, 18.1, 15.7, 29.1, 20.2, 24.3, 12.4, 16.0, 17.1, 64.3, 19.4, 12.0, 14.4, 15.3, 15.0, 14.5, 65.9, 11.6, 72.1, 137.0, 163.0, 21.3, 92.4, 41.3, 60.2, 39.4, 66.3, 64.8, 69.6, 33.1, 121.0, 20.9, 19.2, 17.2, 21.5, 17.4, 16.5, 19.4, 16.0, 16.8, 17.4, 21.2], 
    [49.3, 56.1, 49.8, 51.6, 52.5, 33.4, 64.2, 0, 49.9, 47.1, 49.5, 56.7, 59.5, 50.3, 53.3, 52.7, 48.7, 48.7, 59.7, 49.7, 56.8, 51.7, 49.4, 48.2, 0, 52.8, 53.7, 50.2, 52.1, 52.3, 54.7, 3.9, 54.5, 96.1, 107.0, 134.0, 83.4, 38.8, 36.8, 9.3, 9.3, 60.0, 2.8, 7.8, 104.0, 145.0, 50.8, 49.9, 49.8, 47.3, 50.2, 51.4, 49.8, 49.6, 50.5, 49.1, 45.8], 
    [1.4, 7.8, 3.3, 5.1, 5.1, 18.2, 19.1, 49.7, 0, 3.1, 3.2, 104.0, 39.1, 2.4, 5.4, 8.6, 1.7, 5.3, 39.0, 2.5, 8.2, 4.6, 1.8, 2.7, 49.7, 4.8, 5.2, 2.3, 8.1, 4.7, 6.8, 51.2, 7.4, 56.5, 119.0, 145.0, 38.3, 77.8, 35.2, 41.8, 33.3, 54.7, 50.1, 61.4, 42.5, 106.0, 4.8, 1.9, 1.9, 3.8, 2.3, 3.4, 1.9, 1.7, 2.6, 3.1, 4.8], 
    [2.6, 9.0, 3.2, 4.9, 5.8, 15.9, 18.6, 47.3, 2.6, 0, 2.9, 101.0, 38.0, 3.5, 6.6, 8.6, 1.6, 4.5, 37.9, 2.5, 8.2, 4.9, 2.6, 2.0, 47.3, 6.0, 5.5, 3.5, 7.7, 4.5, 8.0, 48.8, 7.8, 56.6, 120.0, 146.0, 37.9, 75.4, 34.0, 39.4, 32.2, 53.6, 47.7, 52.6, 49.7, 106.0, 5.0, 3.1, 3.0, 3.8, 3.7, 4.6, 3.0, 2.9, 4.6, 2.4, 2.4], 
    [2.5, 7.9, 0.45, 6.6, 5.1, 18.3, 20.8, 49.7, 3.2, 2.9, 0, 109.0, 40.8, 1.4, 5.6, 6.7, 3.2, 7.1, 40.8, 1.8, 5.5, 6.1, 3.4, 4.3, 49.7, 3.7, 6.7, 3.4, 9.8, 6.2, 6.9, 51.2, 8.9, 53.9, 117.0, 143.0, 37.8, 77.8, 36.9, 41.8, 35.0, 56.5, 50.1, 55.0, 42.5, 103.0, 2.1, 1.9, 2.4, 2.3, 2.0, 3.5, 1.8, 2.2, 3.1, 0.5, 4.8], 
    [104.0, 110.0, 104.0, 106.0, 107.0, 88.0, 119.0, 55.9, 104.0, 101.0, 104.0, 0, 114.0, 105.0, 108.0, 107.0, 103.0, 103.0, 114.0, 104.0, 111.0, 106.0, 104.0, 103.0, 55.9, 107.0, 107.0, 105.0, 107.0, 106.0, 109.0, 65.3, 109.0, 125.0, 78.5, 118.0, 138.0, 64.0, 91.4, 63.9, 88.6, 115.0, 64.2, 48.1, 158.0, 164.0, 105.0, 104.0, 104.0, 102.0, 105.0, 106.0, 104.0, 104.0, 105.0, 104.0, 100.0], 
    [38.8, 38.7, 40.9, 31.0, 42.2, 40.7, 32.5, 59.5, 39.1, 37.6, 40.8, 119.0, 0, 40.0, 43.0, 45.3, 38.9, 35.7, 0.28, 40.3, 45.9, 31.8, 39.4, 36.7, 59.5, 42.5, 31.2, 39.9, 29.5, 30.6, 37.2, 61.0, 32.3, 94.2, 151.0, 177.0, 37.6, 87.6, 26.6, 51.6, 24.8, 34.7, 59.9, 64.7, 49.5, 143.0, 42.4, 39.6, 39.5, 41.6, 39.9, 41.1, 39.5, 39.3, 41.1, 40.8, 38.8], 
    [1.9, 8.3, 2.7, 5.0, 5.1, 18.3, 19.6, 49.8, 1.7, 3.2, 2.5, 104.0, 39.7, 0, 5.9, 8.6, 1.8, 5.9, 39.6, 2.5, 7.6, 5.1, 2.3, 2.9, 49.8, 5.4, 5.7, 2.8, 8.6, 4.6, 7.3, 51.3, 7.9, 55.9, 119.0, 145.0, 38.9, 77.8, 35.7, 41.8, 33.9, 55.3, 50.2, 55.0, 43.0, 105.0, 4.1, 2.5, 2.4, 3.8, 2.8, 4.0, 2.4, 2.2, 4.0, 2.5, 4.8], 
    [4.6, 3.4, 6.0, 8.7, 2.2, 22.4, 17.4, 53.9, 5.4, 7.3, 5.9, 113.0, 43.0, 5.1, 0, 11.1, 5.9, 9.2, 42.9, 6.7, 7.4, 7.0, 5.5, 6.6, 53.9, 3.3, 6.7, 4.3, 11.9, 8.3, 3.7, 55.4, 10.3, 55.2, 123.0, 149.0, 37.0, 82.0, 39.0, 45.9, 37.2, 58.6, 54.3, 59.1, 39.0, 105.0, 4.8, 3.7, 3.6, 8.0, 3.8, 3.2, 3.9, 4.4, 4.3, 5.8, 8.9], 
    [9.7, 14.2, 7.2, 12.8, 10.8, 15.8, 27.4, 51.9, 9.5, 9.6, 7.6, 106.0, 47.4, 8.1, 10.9, 0, 9.6, 13.3, 47.4, 7.9, 4.3, 12.9, 10.1, 10.7, 51.9, 8.6, 13.5, 10.6, 16.7, 12.4, 13.6, 53.4, 15.7, 51.2, 114.0, 140.0, 46.7, 80.0, 43.5, 44.0, 40.6, 62.0, 52.3, 57.1, 49.2, 100.0, 7.8, 7.9, 8.0, 6.5, 7.8, 11.7, 8.4, 8.8, 9.4, 7.7, 10.1], 
    [1.9, 8.6, 3.8, 4.2, 5.0, 16.7, 18.0, 48.2, 2.1, 1.6, 3.5, 102.0, 38.0, 2.7, 5.8, 8.6, 0, 4.2, 38.0, 2.6, 8.3, 4.3, 1.8, 1.4, 48.2, 5.2, 4.9, 3.2, 7.0, 3.9, 7.7, 49.7, 7.1, 56.6, 119.0, 145.0, 37.2, 76.3, 34.1, 40.3, 32.2, 53.6, 48.6, 53.4, 49.1, 106.0, 5.7, 2.3, 2.2, 3.8, 2.7, 4.3, 2.2, 2.1, 4.3, 3.0, 3.2], 
    [4.9, 9.8, 7.1, 5.0, 7.5, 17.4, 15.7, 48.9, 5.3, 4.2, 7.0, 103.0, 35.7, 6.2, 9.2, 12.5, 4.3, 0, 35.6, 6.5, 12.1, 5.0, 4.3, 3.3, 48.9, 8.6, 5.6, 6.1, 3.6, 4.6, 8.8, 54.2, 7.9, 60.2, 122.0, 148.0, 35.0, 77.0, 31.7, 41.0, 29.9, 51.3, 53.1, 57.9, 46.8, 109.0, 8.6, 5.7, 5.6, 7.7, 6.1, 6.2, 5.7, 5.5, 7.0, 6.9, 5.7], 
    [38.7, 38.1, 40.9, 30.9, 42.1, 40.6, 32.5, 39.0, 39.0, 37.5, 40.8, 119.0, 0.28, 39.9, 43.0, 45.2, 38.8, 35.6, 0, 40.2, 45.8, 31.8, 39.3, 36.7, 59.7, 42.4, 31.2, 39.8, 29.4, 30.6, 37.1, 61.2, 32.2, 94.1, 151.0, 177.0, 37.5, 87.8, 26.6, 51.8, 24.7, 35.0, 60.1, 65.0, 49.4, 143.0, 42.3, 39.5, 39.4, 41.5, 39.8, 41.0, 39.4, 39.2, 40.2, 40.7, 38.7], 
    [1.8, 8.2, 2.5, 4.9, 5.0, 18.2, 19.5, 49.6, 1.6, 3.1, 2.4, 104.0, 39.6, 1.7, 5.8, 8.5, 1.7, 5.8, 39.5, 0, 7.5, 5.0, 2.2, 2.8, 49.6, 5.3, 5.6, 2.7, 8.5, 4.5, 7.2, 51.2, 7.8, 55.8, 119.0, 145.0, 38.8, 77.7, 35.6, 41.7, 33.8, 55.2, 50.1, 54.9, 42.9, 105.0, 4.0, 2.4, 2.3, 3.7, 2.7, 3.9, 2.3, 2.1, 3.9, 2.3, 4.7], 
    [7.5, 10.8, 5.6, 12.2, 7.4, 23.4, 24.2, 59.6, 8.2, 8.2, 5.5, 114.0, 46.4, 7.0, 6.8, 4.9, 8.2, 12.7, 46.4, 6.5, 0, 11.1, 9.0, 9.3, 59.6, 5.2, 12.3, 8.4, 15.4, 11.8, 10.2, 61.1, 14.5, 49.3, 117.0, 143.0, 43.5, 87.7, 42.5, 51.6, 40.6, 62.1, 60.0, 64.8, 45.8, 98.3, 4.4, 6.9, 7.0, 6.0, 6.8, 8.3, 6.9, 7.2, 8.4, 6.0, 8.7], 
    [3.9, 6.2, 6.2, 2.6, 4.8, 20.6, 12.5, 52.1, 4.6, 6.1, 6.1, 106.0, 31.9, 5.2, 6.9, 11.9, 4.1, 5.0, 31.8, 5.8, 11.1, 0, 3.7, 4.8, 57.2, 7.7, 0.6, 3.7, 6.8, 2.2, 5.2, 53.6, 2.8, 59.4, 122.0, 148.0, 31.7, 80.2, 36.3, 44.1, 34.4, 55.8, 52.5, 57.3, 43.6, 108.0, 7.6, 4.8, 4.7, 7.1, 5.4, 4.0, 4.7, 4.6, 4.8, 6.0, 7.1], 
    [1.4, 8.4, 3.4, 3.8, 4.7, 17.4, 18.0, 48.9, 1.5, 2.3, 3.3, 103.0, 37.9, 2.4, 5.5, 8.5, 0.95, 4.2, 37.9, 2.4, 8.1, 3.9, 0, 1.5, 48.9, 4.9, 4.5, 2.5, 7.0, 3.5, 7.4, 50.4, 6.7, 56.4, 119.0, 145.0, 37.1, 77.0, 34.0, 41.0, 32.1, 53.5, 49.3, 54.2, 43.1, 105.0, 4.9, 2.0, 1.9, 3.7, 2.4, 3.6, 1.9, 1.8, 3.6, 3.2, 4.0], 
    [2.2, 9.5, 4.6, 4.7, 5.9, 17.2, 17.1, 48.7, 2.8, 2.1, 4.5, 103.0, 36.7, 3.7, 6.7, 9.7, 1.7, 3.2, 36.6, 3.6, 9.3, 4.8, 2.0, 0, 48.7, 6.1, 5.4, 3.4, 6.2, 4.3, 8.7, 55.2, 7.6, 57.7, 120.0, 146.0, 36.4, 76.8, 32.8, 40.8, 30.9, 52.3, 49.1, 53.9, 48.2, 107.0, 6.1, 3.2, 3.1, 4.9, 3.6, 4.6, 3.1, 3.0, 4.5, 4.4, 3.7], 
    [49.1, 55.7, 49.8, 51.6, 52.5, 33.4, 64.2, 0, 49.4, 46.8, 49.5, 56.7, 59.5, 50.3, 53.3, 45.6, 48.3, 48.7, 59.7, 49.6, 48.5, 51.7, 49.4, 48.2, 0, 52.8, 52.3, 50.2, 52.1, 51.3, 54.7, 3.9, 54.5, 96.1, 107.0, 134.0, 83.4, 38.8, 36.8, 9.3, 34.0, 60.0, 2.8, 7.8, 103.0, 145.0, 50.8, 49.9, 49.8, 47.3, 50.2, 51.4, 49.8, 49.6, 50.5, 49.1, 45.5], 
    [4.2, 6.0, 3.8, 8.4, 2.5, 20.9, 19.4, 52.4, 5.0, 5.7, 3.7, 112.0, 42.6, 3.5, 2.7, 7.7, 5.5, 8.8, 42.5, 5.4, 5.2, 7.8, 5.2, 6.2, 52.4, 0, 8.4, 5.1, 11.6, 8.0, 5.3, 53.9, 10.7, 53.5, 119.0, 145.0, 38.6, 80.5, 38.6, 44.4, 36.8, 58.2, 52.8, 57.6, 41.0, 103.0, 1.9, 3.4, 3.2, 5.0, 2.9, 3.5, 3.5, 4.0, 4.4, 4.0, 7.5], 
    [4.5, 5.8, 6.8, 2.6, 4.9, 21.2, 12.1, 52.7, 5.2, 6.1, 6.7, 107.0, 31.3, 5.8, 7.5, 12.5, 4.7, 5.6, 31.2, 6.4, 11.7, 0.6, 4.3, 5.4, 52.7, 8.3, 0, 4.3, 7.8, 2.8, 4.9, 54.2, 0.16, 60.0, 123.0, 149.0, 31.4, 80.8, 36.9, 44.7, 35.0, 61.3, 53.1, 57.9, 43.2, 109.0, 8.2, 5.4, 5.3, 7.7, 6.0, 4.6, 5.3, 5.2, 5.4, 6.6, 7.7], 
    [1.7, 5.5, 3.9, 5.1, 2.5, 19.7, 16.7, 51.8, 3.3, 5.2, 3.8, 111.0, 40.9, 3.0, 4.1, 9.1, 3.2, 5.8, 40.8, 4.6, 7.6, 4.1, 2.6, 3.8, 51.8, 4.1, 4.7, 0, 8.6, 4.7, 4.5, 59.4, 6.9, 55.9, 121.0, 147.0, 36.0, 79.9, 36.9, 43.9, 35.1, 56.5, 52.2, 56.4, 40.2, 105.0, 4.1, 1.7, 1.5, 5.9, 1.7, 1.1, 1.8, 1.8, 1.1, 3.7, 6.2], 
    [7.7, 12.6, 9.9, 5.0, 11.2, 20.8, 15.3, 52.3, 8.1, 7.9, 9.8, 106.0, 31.1, 9.0, 12.0, 15.3, 7.1, 3.6, 31.0, 9.3, 14.9, 6.8, 7.1, 6.1, 52.3, 11.4, 6.8, 8.9, 0, 4.6, 11.6, 53.8, 7.9, 63.2, 125.0, 151.0, 34.6, 80.4, 35.0, 44.3, 33.2, 54.6, 52.7, 57.5, 46.4, 112.0, 11.4, 8.5, 8.5, 10.5, 8.9, 8.9, 8.5, 8.3, 9.2, 9.7, 9.1], 
    [3.7, 8.4, 6.3, 0.35, 6.0, 20.2, 13.3, 51.7, 4.5, 5.6, 6.2, 106.0, 30.7, 5.4, 7.6, 11.4, 3.7, 4.6, 30.6, 5.4, 11.1, 2.2, 3.3, 4.4, 51.7, 7.9, 2.6, 4.4, 4.6, 0, 7.4, 53.2, 3.6, 59.4, 122.0, 148.0, 32.6, 79.8, 35.8, 43.7, 34.0, 55.4, 52.1, 56.9, 44.4, 108.0, 7.8, 5.0, 4.9, 6.7, 5.3, 4.7, 4.9, 4.7, 5.5, 6.2, 6.7], 
    [5.3, 3.0, 7.0, 7.0, 3.3, 23.4, 13.8, 54.8, 6.3, 8.2, 6.9, 114.0, 36.8, 6.0, 4.8, 12.2, 6.8, 8.1, 36.7, 7.5, 10.8, 4.7, 6.1, 7.9, 54.8, 5.9, 4.4, 4.1, 13.3, 6.9, 0, 56.4, 6.6, 59.1, 124.0, 150.0, 33.0, 82.9, 39.4, 46.9, 37.6, 60.5, 55.3, 60.0, 37.6, 108.0, 7.1, 4.7, 4.6, 8.8, 4.8, 3.3, 4.9, 4.9, 4.2, 6.8, 9.8], 
    [50.8, 57.2, 51.4, 59.1, 54.0, 34.9, 65.7, 3.9, 50.9, 48.3, 51.0, 53.2, 61.0, 51.8, 54.8, 53.8, 49.8, 50.2, 61.3, 51.1, 58.0, 53.2, 50.9, 49.7, 3.9, 54.3, 59.7, 51.7, 53.6, 52.8, 56.8, 0, 56.0, 97.6, 109.0, 136.0, 84.9, 39.3, 38.3, 10.8, 35.5, 61.6, 1.3, 10.1, 105.0, 147.0, 52.3, 51.4, 51.3, 48.8, 51.7, 52.9, 51.3, 51.1, 52.0, 50.6, 47.0], 
    [6.7, 7.7, 9.0, 3.7, 7.1, 23.4, 12.7, 59.8, 7.4, 8.3, 8.9, 114.0, 32.4, 8.1, 9.7, 14.7, 6.9, 7.5, 32.3, 8.6, 13.9, 2.8, 6.5, 7.3, 59.8, 10.5, 0.16, 6.5, 8.9, 3.6, 6.7, 61.3, 0, 62.3, 125.0, 151.0, 32.0, 83.0, 38.8, 51.9, 37.3, 58.4, 60.2, 65.0, 42.4, 111.0, 10.5, 8.4, 7.5, 9.9, 8.4, 6.8, 8.5, 7.4, 7.6, 8.8, 9.9], 
    [56.4, 58.9, 54.0, 60.5, 55.7, 61.4, 72.5, 97.5, 57.1, 56.5, 53.8, 125.0, 94.7, 54.8, 55.2, 51.8, 57.1, 61.0, 94.7, 54.8, 49.2, 60.0, 57.3, 58.2, 97.5, 53.5, 60.6, 56.7, 63.7, 60.1, 58.5, 99.0, 62.8, 0, 118.0, 117.0, 91.8, 126.0, 90.8, 89.6, 89.0, 110.0, 97.9, 103.0, 93.4, 67.9, 52.8, 55.2, 55.4, 54.4, 55.1, 56.6, 55.7, 56.1, 56.2, 54.3, 57.0], 
    [119.0, 126.0, 117.0, 122.0, 121.0, 112.0, 137.0, 107.0, 119.0, 120.0, 117.0, 78.5, 151.0, 119.0, 123.0, 113.0, 119.0, 122.0, 151.0, 117.0, 117.0, 122.0, 120.0, 121.0, 107.0, 119.0, 123.0, 120.0, 125.0, 122.0, 124.0, 109.0, 125.0, 118.0, 0, 64.2, 156.0, 144.0, 141.0, 114.0, 138.0, 164.0, 108.0, 99.1, 165.0, 144.0, 118.0, 120.0, 120.0, 115.0, 119.0, 121.0, 119.0, 120.0, 120.0, 117.0, 118.0], 
    [145.0, 152.0, 144.0, 148.0, 148.0, 138.0, 163.0, 133.0, 145.0, 146.0, 143.0, 118.0, 177.0, 145.0, 149.0, 139.0, 145.0, 148.0, 177.0, 143.0, 143.0, 148.0, 146.0, 147.0, 133.0, 145.0, 149.0, 146.0, 151.0, 148.0, 150.0, 136.0, 151.0, 122.0, 64.2, 0, 182.0, 170.0, 168.0, 140.0, 165.0, 191.0, 134.0, 125.0, 191.0, 147.0, 144.0, 146.0, 146.0, 141.0, 145.0, 147.0, 145.0, 146.0, 147.0, 143.0, 144.0], 
    [34.5, 33.5, 36.8, 34.6, 36.4, 52.1, 20.6, 83.6, 38.3, 37.7, 36.7, 143.0, 37.6, 35.9, 36.8, 45.6, 38.1, 35.0, 37.5, 39.5, 43.6, 31.6, 35.3, 36.4, 83.6, 38.7, 31.3, 33.7, 34.6, 34.2, 33.7, 85.1, 30.9, 91.3, 156.0, 182.0, 0, 112.0, 57.5, 75.7, 55.7, 70.6, 84.0, 88.9, 11.8, 140.0, 40.2, 35.4, 35.2, 41.1, 36.7, 33.9, 35.5, 35.2, 36.1, 36.7, 40.5], 
    [77.3, 83.9, 78.0, 79.8, 80.7, 61.6, 92.4, 38.7, 77.6, 75.0, 77.7, 64.5, 87.7, 78.5, 81.5, 80.5, 76.5, 76.9, 87.9, 77.8, 84.7, 79.9, 77.6, 76.4, 38.7, 81.0, 80.5, 78.4, 80.3, 79.5, 82.9, 39.2, 82.7, 124.0, 144.0, 171.0, 112.0, 0, 65.0, 37.5, 62.2, 60.9, 38.1, 44.8, 123.0, 173.0, 79.0, 78.0, 78.0, 75.5, 78.4, 79.6, 78.0, 77.8, 78.7, 77.3, 73.7], 
    [32.8, 39.4, 35.0, 34.3, 36.2, 34.7, 45.2, 36.8, 33.1, 31.6, 34.8, 91.0, 26.3, 34.0, 37.1, 39.3, 32.9, 29.7, 26.2, 34.3, 39.9, 34.3, 33.4, 30.8, 36.8, 36.5, 34.9, 33.9, 33.1, 33.9, 38.4, 38.3, 37.1, 88.2, 141.0, 171.0, 57.2, 64.9, 0, 28.9, 2.8, 35.3, 37.2, 42.0, 69.0, 137.0, 36.4, 33.6, 33.5, 35.6, 33.9, 35.1, 33.5, 33.3, 34.3, 34.8, 32.8], 
    [39.8, 46.4, 40.6, 42.3, 43.2, 24.1, 54.9, 9.6, 40.1, 37.5, 40.2, 63.8, 50.2, 41.0, 44.0, 43.0, 39.0, 39.4, 50.4, 40.3, 47.2, 42.4, 40.1, 38.9, 9.6, 43.5, 43.0, 40.9, 42.8, 42.0, 45.4, 11.1, 45.2, 86.8, 114.0, 141.0, 74.1, 38.4, 27.5, 0, 24.7, 50.7, 10.0, 14.8, 86.0, 136.0, 41.5, 40.6, 40.5, 38.0, 40.9, 42.1, 40.5, 40.3, 41.2, 39.8, 36.2], 
    [30.9, 37.2, 33.1, 32.4, 34.4, 32.8, 43.3, 34.0, 31.3, 29.8, 33.0, 88.1, 24.4, 32.2, 35.2, 37.5, 31.0, 27.8, 24.4, 32.4, 38.1, 32.5, 31.5, 28.9, 34.0, 34.6, 33.1, 32.1, 31.2, 32.0, 36.3, 35.5, 35.3, 86.4, 138.0, 165.0, 55.3, 62.1, 2.8, 26.0, 0, 33.5, 34.4, 39.2, 67.2, 135.0, 34.6, 31.7, 31.6, 33.7, 32.1, 33.2, 31.6, 31.5, 32.4, 32.9, 30.9], 
    [53.3, 60.0, 55.5, 54.8, 56.8, 55.2, 65.7, 60.1, 53.6, 52.2, 55.4, 119.0, 34.8, 54.5, 57.6, 60.9, 53.4, 50.2, 35.0, 54.8, 60.4, 54.8, 53.9, 51.3, 60.1, 57.0, 55.4, 54.5, 53.6, 54.4, 59.0, 61.6, 57.7, 109.0, 164.0, 191.0, 70.8, 60.9, 35.1, 52.1, 33.2, 0, 60.5, 65.3, 82.6, 158.0, 57.0, 54.1, 54.0, 56.1, 54.5, 55.6, 54.0, 53.9, 54.8, 55.3, 53.3], 
    [49.7, 56.1, 50.3, 52.0, 52.9, 33.8, 64.6, 2.8, 49.8, 47.2, 49.9, 52.1, 59.9, 50.7, 53.7, 52.7, 48.7, 49.1, 60.2, 50.0, 56.9, 52.1, 49.8, 48.6, 2.8, 53.2, 52.7, 50.6, 52.5, 51.7, 55.7, 1.3, 54.9, 96.5, 108.0, 135.0, 83.8, 38.2, 37.2, 9.7, 34.4, 60.5, 0, 9.0, 95.7, 146.0, 51.2, 50.3, 50.2, 47.7, 50.6, 51.8, 50.2, 50.0, 50.9, 49.5, 45.9], 
    [54.6, 60.9, 55.1, 56.9, 57.8, 38.6, 69.4, 7.8, 54.6, 52.0, 54.8, 55.2, 64.8, 55.5, 58.6, 57.6, 53.6, 54.0, 65.0, 54.8, 61.7, 56.9, 54.6, 53.5, 7.8, 58.0, 57.5, 55.5, 57.3, 56.5, 60.0, 10.1, 59.7, 101.0, 99.1, 126.0, 88.7, 44.8, 42.0, 14.6, 39.2, 65.3, 9.0, 0, 101.0, 150.0, 56.0, 55.1, 55.0, 52.5, 55.5, 56.6, 55.0, 54.9, 55.8, 54.3, 50.7], 
    [41.4, 35.8, 43.1, 46.4, 38.7, 64.0, 32.5, 95.5, 42.5, 49.5, 43.0, 155.0, 49.4, 42.1, 39.2, 49.8, 42.9, 46.8, 49.4, 43.7, 46.1, 43.5, 42.2, 48.2, 95.5, 41.0, 43.2, 40.2, 46.4, 46.1, 36.1, 97.0, 42.8, 98.2, 168.0, 194.0, 11.8, 124.0, 69.4, 87.5, 67.5, 82.5, 95.9, 101.0, 0, 147.0, 42.5, 40.8, 40.7, 50.6, 40.9, 40.0, 41.0, 41.0, 40.3, 42.9, 52.3], 
    [108.0, 109.0, 105.0, 112.0, 107.0, 113.0, 123.0, 149.0, 108.0, 108.0, 105.0, 167.0, 146.0, 106.0, 106.0, 103.0, 108.0, 112.0, 146.0, 106.0, 101.0, 111.0, 109.0, 109.0, 149.0, 105.0, 112.0, 107.0, 115.0, 111.0, 110.0, 150.0, 114.0, 70.3, 147.0, 148.0, 143.0, 177.0, 142.0, 141.0, 140.0, 162.0, 149.0, 154.0, 145.0, 0, 104.0, 107.0, 106.0, 106.0, 106.0, 108.0, 106.0, 107.0, 108.0, 106.0, 108.0], 
    [3.5, 8.1, 1.7, 7.6, 4.2, 19.4, 19.3, 50.9, 4.2, 4.5, 1.6, 110.0, 37.5, 2.5, 4.9, 6.3, 4.2, 8.1, 37.4, 3.3, 4.8, 7.1, 4.4, 5.4, 50.9, 2.2, 7.7, 3.8, 10.9, 7.3, 7.0, 52.4, 10.0, 53.1, 118.0, 144.0, 38.6, 79.0, 37.9, 43.0, 36.1, 57.5, 51.3, 56.2, 42.8, 102.0, 0, 2.3, 2.5, 3.6, 2.2, 3.8, 2.8, 3.2, 3.8, 2.1, 6.1], 
    [1.6, 6.2, 2.1, 5.7, 3.1, 19.6, 17.4, 51.1, 3.1, 3.7, 2.0, 105.0, 35.6, 1.3, 4.3, 7.8, 3.1, 6.2, 39.9, 3.1, 6.3, 5.4, 2.5, 4.2, 51.1, 2.9, 6.0, 1.9, 8.9, 5.3, 5.2, 52.6, 8.2, 54.6, 119.0, 145.0, 36.7, 79.2, 36.0, 43.1, 34.2, 55.6, 51.5, 56.3, 40.9, 104.0, 2.7, 0, 0.6, 4.1, 0.35, 1.9, 1.9, 2.1, 1.4, 2.0, 6.1], 
    [1.3, 6.3, 2.7, 5.8, 3.5, 19.1, 19.4, 50.6, 2.1, 4.0, 2.6, 105.0, 39.7, 1.8, 4.3, 8.2, 2.6, 5.9, 39.6, 3.4, 6.7, 5.4, 2.2, 3.3, 50.6, 3.7, 6.0, 2.2, 8.7, 5.4, 5.4, 52.1, 8.3, 55.0, 120.0, 146.0, 38.7, 78.7, 35.7, 42.7, 33.9, 55.3, 51.0, 55.8, 41.0, 104.0, 3.2, 0.5, 0, 4.7, 0.85, 2.0, 0.6, 0.65, 0.75, 2.6, 5.6], 
    [4.0, 10.1, 2.5, 7.1, 7.2, 16.0, 18.9, 47.5, 3.8, 3.9, 2.1, 102.0, 41.8, 3.6, 7.3, 5.5, 3.8, 7.4, 41.6, 2.2, 5.9, 7.2, 4.4, 5.0, 47.5, 5.0, 7.7, 4.9, 10.8, 6.7, 10.0, 49.0, 9.9, 54.4, 115.0, 141.0, 38.4, 75.6, 38.0, 39.6, 36.2, 57.3, 47.9, 52.7, 45.0, 103.0, 3.5, 4.1, 4.4, 0, 4.2, 6.0, 4.0, 4.3, 5.2, 2.3, 3.7], 
    [1.6, 6.0, 3.0, 5.7, 3.0, 19.4, 17.2, 50.9, 2.4, 4.3, 2.9, 105.0, 35.6, 2.1, 3.6, 8.3, 2.9, 6.2, 39.9, 3.7, 6.7, 5.2, 2.5, 3.6, 50.9, 3.1, 5.8, 1.7, 8.9, 5.3, 5.0, 52.4, 8.1, 55.1, 120.0, 146.0, 36.5, 79.0, 36.0, 42.9, 34.1, 55.6, 51.3, 56.1, 40.7, 104.0, 3.2, 0.75, 0.6, 5.0, 0, 1.7, 0.9, 0.9, 1.7, 2.8, 5.9], 
    [2.6, 4.6, 4.0, 4.9, 1.6, 20.4, 15.8, 51.9, 3.4, 5.3, 3.9, 111.0, 40.8, 3.0, 3.2, 9.2, 3.9, 6.0, 40.7, 4.7, 7.7, 3.9, 3.8, 4.7, 51.9, 3.6, 4.5, 1.1, 8.8, 4.5, 3.6, 4.0, 6.7, 56.0, 121.0, 147.0, 35.0, 79.9, 37.0, 43.9, 35.1, 56.5, 52.3, 57.1, 39.2, 105.0, 4.1, 1.7, 1.6, 6.1, 1.8, 0, 1.9, 1.9, 1.2, 3.8, 6.9], 
    [1.5, 6.5, 2.0, 5.7, 3.5, 19.4, 17.7, 50.8, 2.8, 4.3, 1.9, 110.0, 39.9, 1.1, 4.1, 8.2, 2.8, 6.1, 39.8, 3.0, 6.7, 5.6, 2.5, 4.0, 50.8, 3.3, 6.2, 2.1, 8.9, 5.3, 5.5, 52.3, 8.5, 55.0, 119.0, 145.0, 37.0, 78.9, 35.9, 42.9, 34.1, 55.5, 51.3, 56.1, 41.2, 104.0, 3.1, 0.4, 0.55, 4.2, 0.75, 2.2, 0, 0.16, 1.3, 1.8, 5.9], 
    [1.4, 6.3, 2.0, 5.5, 3.3, 19.2, 17.5, 50.7, 2.2, 4.1, 1.9, 105.0, 39.7, 1.1, 3.9, 8.2, 2.7, 5.9, 39.7, 3.0, 6.7, 5.0, 2.3, 3.4, 50.7, 3.4, 6.1, 2.0, 8.7, 5.1, 5.3, 52.2, 8.3, 55.0, 120.0, 146.0, 36.8, 78.9, 35.8, 42.7, 33.9, 55.3, 51.2, 55.9, 41.0, 104.0, 3.2, 0.45, 0.4, 4.1, 0.85, 2.0, 0.16, 0, 1.1, 1.8, 5.7], 
    [1.4, 5.9, 2.8, 5.5, 2.7, 19.2, 17.1, 50.7, 2.2, 4.1, 2.7, 110.0, 35.3, 1.9, 3.5, 8.0, 2.7, 5.9, 35.3, 3.5, 6.5, 5.0, 2.3, 3.4, 50.7, 2.9, 5.6, 1.5, 8.7, 5.1, 4.9, 52.2, 7.8, 54.8, 119.0, 146.0, 36.4, 78.8, 35.8, 42.7, 33.9, 55.3, 51.1, 55.9, 40.6, 104.0, 2.9, 0.55, 0.35, 4.8, 0.55, 1.5, 0.65, 0.7, 0, 2.6, 5.7], 
    [2.4, 7.8, 0.85, 6.9, 5.0, 18.4, 20.9, 49.9, 3.2, 2.4, 0.5, 109.0, 36.4, 1.4, 5.8, 6.7, 3.1, 7.0, 36.3, 1.9, 6.0, 6.0, 3.4, 4.3, 49.9, 4.0, 6.6, 3.3, 9.8, 6.2, 6.8, 51.4, 8.8, 54.3, 117.0, 143.0, 37.7, 78.0, 36.8, 41.9, 35.0, 56.4, 50.3, 55.1, 42.5, 103.0, 2.6, 1.9, 2.3, 2.5, 1.9, 3.5, 1.7, 2.1, 3.0, 0, 4.4], 
    [3.9, 10.2, 4.2, 6.2, 7.1, 14.3, 20.1, 45.8, 3.9, 1.3, 3.9, 100.0, 37.7, 4.8, 7.9, 8.2, 2.9, 4.7, 37.6, 3.9, 7.9, 6.2, 3.9, 2.8, 45.8, 7.3, 6.8, 4.8, 8.0, 5.8, 9.9, 47.3, 9.0, 56.2, 118.0, 144.0, 39.4, 73.9, 33.8, 37.9, 31.9, 53.3, 46.2, 51.0, 45.5, 105.0, 5.3, 4.4, 4.3, 2.9, 4.8, 5.9, 4.3, 4.2, 5.1, 3.6, 0] 
    ])

    labels =  ["Central Museum of Nagpur nagpur", "Divekar Puratan Vastu Sangrahalay nagpur", "Raman Science Centre & Planetarium, Raman Science Centre, Subhash Rd, Empress City, Nagpur", "Zonal Anthropological Museum nagpur",  "Deekshabhoomi nagpur", "Dragon Palace Temple Nagpur", "Suraburdi nagpur", "Ramtek Fort nagpur", "Sitabuldi Fort nagpur", "Narrow Gauge Rail Museum nagpur", "Gandhi Sagar Lake nagpur", "Ambagad Fort, FJ5W+CV2, Ambagad,tah.Tumsar,Dist.Bhandara", "Adasa nagpur",
           "Shri Ganesh Temple Tekdi nagpur", "Sai Baba Mandir 437C+83G, Wardha Rd, Near Sai Mandir, Sawarkar Nagar, Vivekanand Nagar, Nagpur, Maharashtra 440015",  "Swaminarayan Temple nagpur", "St. Francis De Sales Cathedral nagpur", "Masjid Markaz nagpur", "Adasa Ganpati Temple nagpur", "Sri Poddareshwar Ram Mandir nagpur", "Hazrat Baba Tajuddin Dargah nagpur", "Telankhedi Hanuman Temple nagpur", "All Saint's Cathedral Church nagpur", "St. Thomas Church nagpur", "Ramtek Temple nagpur","St. Anthony Church nagpur",
           "Futala Lake nagpur", "Maharajbagh Zoo nagpur", "Gorewada Lake nagpur", "Seminary Hill nagpur", "Ambazari Lake nagpur", "Khindsi Lake nagpur", "Satpuda Botanical Garden, 524Q+WWM, Vayusena Nagar, Nagpur", "Karhandla Gate Umred Karhandla Wildlife Sanctuary, RCW2+676, Nagpur",  "Nagzira Wildlife Sanctuary nagpur", "Nawegaon Nagzira Tiger Reserve, X5G8+63F, Nishani",
           "Fun N Food Village Nagpur", "Pench Tiger Reserve Nagpur", "Official-Dwarka Water Park Nagpur", "Ramdham nagpur", "Waki Woods nagpur", "Khekranala nagpur", "CAC Adventure Camp Ramtek", "Meghdhoot Agri And Adventure Park", "Waki, Waghville Elite Aqua Park", "Tadoba-Andhari National Park",
           "VR Mall Nagpur", "Glocal Square Mall Nagpur", "Eternity Mall nagpur", "Itwri Market 5436+G3C, Teen Nal Chowk, Itwari, Nagpur, Maharashtra 440002", "Shree Shivam Shopping Complex nagpur", "Reliance Centro nagpur", "Apna Bazar nagpur", "Meena Bazar nagpur", "Sadar Bazaar nagpur", "Empress Mall nagpur", "Jaswant Tuli Mall nagpur"]
    
    label_to_index = {label: i for i, label in enumerate(labels)}     # create a dictionary to map each label to its index in the distance matrix
    mask = [label_to_index[place] for place in places]             # create a mask to extract the rows/columns corresponding to the selected places

    # extract the submatrix corresponding to the selected places
    submatrix = dist_matrix[np.ix_(mask, mask)]
    #print("Sub Matrix :\n",submatrix)

    # Adding user's starting point in the list
    places.insert(0,address)

    # Add new node at position 0
    new_size = submatrix.shape[0] + 1
    adj_matrix = np.zeros((new_size, new_size), dtype=float)

    # Set default values for new row and column
    if np.all(submatrix == submatrix.T):
        adj_matrix[0, 0] = 0  # undirected graph
    else:
        # directed graph
        adj_matrix[0, :] = np.zeros(new_size, dtype=float)
        adj_matrix[:, 0] = np.zeros(new_size, dtype=float)

    # Add connections for new node
    adj_matrix[1:new_size, 1:new_size] = submatrix

    for i, val in enumerate(source):
        adj_matrix[i+1, 0] = val
        adj_matrix[0, i+1] = val       

    #df = pd.DataFrame(adj_matrix,index=places,columns=places)
    #df 
    result = travellingSalesmanProblem(adj_matrix, places)
    #shortest_path_order = [places[i] for i in result]
    #print(shortest_path_order)
    return result 